<div id="entityLinksPanel" class="space-y-3">
  {% include 'entity_links/partials/_links_form.html' %}

  <div class="overflow-hidden border rounded-xl" style="border-color:var(--border)">
    <table class="w-full text-sm">
      <thead>
        <tr class="border-b" style="border-color:var(--border)">
          <th class="text-left px-3 py-2">Typ</th>
          <th class="text-left px-3 py-2">Titel</th>
          <th class="text-left px-3 py-2">Link-Typ</th>
          <th class="text-left px-3 py-2">Zeit</th>
          <th class="text-left px-3 py-2">Aktion</th>
        </tr>
      </thead>
      <tbody>
        {% for row in links %}
        {% set d = row.display or {} %}
        <tr class="border-b" style="border-color:var(--border)">
          <td class="px-3 py-2">
            <span class="inline-flex items-center rounded border px-2 py-0.5 text-xs" style="border-color:var(--border)">{{ d.type or row.other_type }}</span>
          </td>
          <td class="px-3 py-2">
            {% if d.href %}
              <a class="font-medium hover:underline" href="{{ d.href }}">{{ d.title or '(unbekannt)' }}</a>
            {% else %}
              <span class="font-medium">{{ d.title or '(unbekannt)' }}</span>
            {% endif %}
            <div class="muted text-xs">{{ d.subtitle or (d.id[:8] if d.id else (row.other_id[:8] if row.other_id else '-')) }}</div>
          </td>
          <td class="px-3 py-2">{{ row.link_type }}</td>
          <td class="px-3 py-2">{{ row.created_at }}</td>
          <td class="px-3 py-2">
            <form method="post" action="/entity-links/{{ row.id }}/delete" hx-post="/entity-links/{{ row.id }}/delete" hx-target="#entityLinksPanel" hx-swap="outerHTML">
              <input type="hidden" name="context_entity_type" value="{{ entity_type }}">
              <input type="hidden" name="context_entity_id" value="{{ entity_id }}">
              <button class="btn-outline px-2 py-1 text-xs" type="submit" {% if read_only %}disabled{% endif %}>Entfernen</button>
            </form>
          </td>
        </tr>
        {% else %}
        <tr><td class="px-3 py-3 muted" colspan="5">Keine Verkn√ºpfungen vorhanden.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
